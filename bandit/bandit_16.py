#!/usr/bin/python3.9

"""This script is a solution to Overthewire Bandit level 16."""

import time
import paramiko

s = paramiko.SSHClient()
s.set_missing_host_key_policy(paramiko.AutoAddPolicy())

s.connect(
    "bandit.labs.overthewire.org",
    port=2220, 
    username="bandit16",
    password="JQttfApK4SeyHwDlI9SXGR50qclOAil1",
    look_for_keys=False, 
    allow_agent=False)

cmd = ["echo \"JQttfApK4SeyHwDlI9SXGR50qclOAil1\"",
    "openssl s_client -ign_eof --connect localhost:31790 2>/dev/null",
    "grep -A26 'BEGIN RSA PRIVATE KEY'"]

stdin, stdout, stderr = s.exec_command('|'.join(cmd))

print(stdout.read().decode('utf-8'))

stdin.close(); s.close()
