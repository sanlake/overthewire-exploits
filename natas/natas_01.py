#!/usr/bin/python3.9

"""This script is a solution to Overthewire Natas level 1."""

import requests as r
from requests.auth import HTTPBasicAuth
from fake_useragent import UserAgent

url = "http://natas1.natas.labs.overthewire.org/"

lvl_user = "natas1"
lvl_pass = "g9D9cREhslqBKtcA2uocGHPfMZVzeFK6"

headers = {"User-Agent": UserAgent().random}

try:
    res = r.get(url, headers=headers, auth=HTTPBasicAuth(lvl_user, lvl_pass))
    password = (res.text.split(" ")[-2]) if res.status_code == 200 else ""
    status = res.status_code
except Exception as e:
    print("[ERROR]", e, "\n")
    exit(-1)

if password and password.isalnum() and len(password) == 32:
    print("[PASSWORD]", password)
else:
    print(
        f"[FAIL] - [Status: {status}]",
        f"[Password({len(password)}): {password}]")
