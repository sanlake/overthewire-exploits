#!/usr/bin/python3.9

"""This script is a solution to Overthewire Leviathan level 4."""

import paramiko

s = paramiko.SSHClient()
s.set_missing_host_key_policy(paramiko.AutoAddPolicy())

s.connect(
    "leviathan.labs.overthewire.org",
    port=2223, 
    username="leviathan4",
    password="AgvropI4OA",
    look_for_keys=False, 
    allow_agent=False)

cmd = [
    ".trash/bin",
    "tr -d ' '",
    'xargs -I@ echo "obase=16; ibase=2; @"',
    "bc",
    "xxd -r -p"
]

stdin, stdout, stderr = s.exec_command('|'.join(cmd))

password = stdout.read().decode('utf-8').strip()

if password and password.isalnum() and len(password) == 10:
    print("[PASSWORD]", password)
else:
    print(
        f"[FAIL]",
        f"[Password({len(password)}): {password}]")

stdin.close(); s.close()
